<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>ç¾ä¸½çš„æ±¤   xlsxæ ¼å¼   csv æ ¼å¼ | posierd</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://posierd.github.io/favicon.ico?v=1587626387469">
<link rel="stylesheet" href="https://posierd.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ğŸ˜ƒğŸ˜ƒğŸ˜ƒ
'''
ç¾ä¸½çš„æ±¤çš„2ç§ç”¨æ³•

ä¿å­˜æ•°æ®æ–‡ä»¶
xlsx æ ¼å¼æ–‡ä»¶
csv æ–‡ä»¶
'''

from bs4 import BeautifulSoup
'''

æ ¹æ® class çš„å±æ€§å€¼ æ¥æå–æ•°æ®
find_all æ³¨æ„åœ¨æ·»åŠ ..." />
    <meta name="keywords" content="ä¸ªäººæ€»ç»“" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://posierd.github.io">
        <img src="https://posierd.github.io/images/avatar.png?v=1587626387469" class="site-logo">
        <h1 class="site-title">posierd</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æ¸©æ•…è€ŒçŸ¥æ–°
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://posierd.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">ç¾ä¸½çš„æ±¤   xlsxæ ¼å¼   csv æ ¼å¼</h2>
            <div class="post-date">2020-04-17</div>
            
            <div class="post-content" v-pre>
              <p>ğŸ˜ƒğŸ˜ƒğŸ˜ƒ</p>
<pre><code class="language-python">'''
ç¾ä¸½çš„æ±¤çš„2ç§ç”¨æ³•

ä¿å­˜æ•°æ®æ–‡ä»¶
xlsx æ ¼å¼æ–‡ä»¶
csv æ–‡ä»¶
'''

from bs4 import BeautifulSoup
'''

æ ¹æ® class çš„å±æ€§å€¼ æ¥æå–æ•°æ®
find_all æ³¨æ„åœ¨æ·»åŠ  class çš„å€¼æ˜¯  class æœ‰ä¸‹åˆ’çº¿  class_=&quot;å±æ€§å€¼&quot;
ä¾‹ï¼šè±†ç“£top æ’è¡Œæ¦œçš„ç”µå½±ä¿¡æ¯(ç›®æ ‡æ•°æ®åœ¨æ ‡ç­¾å¤–)    time: 2020-02-21
æ•°æ®è½¬æ¢   å˜é‡ = BeautifulSoup(è¯·æ±‚è¿”å›.text,'html.parser')

æ‰¾å‡ºæœ€å°çš„çˆ¶çº§ä¿¡æ¯  å…¶åŒ…æ‹¬  name  å¯¼æ¼”å  ....ç­‰  list æ•°æ®
åœ¨é€šè¿‡ for  éå†  åˆ†åˆ«å»æŸ¥æ‰¾ éœ€è¦çš„æ•°æ®
find  æå–æ•°æ®
åœ¨è·å–å…¶ç”µå½±åç§°çš„è‹±æ–‡åæ—¶ï¼ˆæ³¨æ„è¿™é‡Œ  findï¼ˆä¸­æ–‡ï¼‰/   find_all(è‹±æ–‡ for )ï¼‰ï¼Œæœ‰äº›æ•°æ®å¯èƒ½å°±æ²¡æœ‰è¿™ä¸ª åŠ ä¸ªåˆ¤æ–­   
æœ‰äº› ç”µå½±ä¸­å¹¶æ— æ¨èè¯­  åŠ ä¸ª try  æ¥è§£å†³
æŸ¥æ‰¾ urlï¼ˆåœ¨htmlæ ‡ç­¾å†…ï¼‰ findï¼ˆï¼‰.find()['urldçš„å¥æ˜']



åœ¨  â€œå…¨å±€â€æ·»åŠ ä¸€ä¸ªç©ºçš„åˆ—è¡¨  ï¼ˆç”¨äºå­˜å‚¨ä¿å­˜ä¿¡æ¯ï¼‰
å½“åœ¨ for å¾ªç¯ä¸‹æ‰¾å‡ºäº†æ‰€æœ‰æ•°æ®
ç”¨  å…¨å±€å®šä¹‰çš„ç©ºåˆ—è¡¨   æ¥æ¥æ”¶å…¨éƒ¨æ¥æ”¶  .append([æ•°æ®1ï¼Œæ•°æ®2ï¼Œæ•°æ®3.....])


****å°† å…¶ ä¿¡æ¯ä¿å­˜   .xlsx ä¸­****

è°ƒç”¨åº“
å…¨å±€
import openpyxl

file = openpyxl.Workbook()   #  å»ºç«‹ä¸€ä¸ªå·¥ä½œè–„
sheet = file.active   #  å»ºç«‹å·¥ä½œè¡¨
sheet.title = 'è±†ç“£çˆ¬è™«'   # å‘½å

sheet['A1'] = 'æ’å',
sheet['B1'] = 'ç”µå½±å',
.....  å…¨éƒ¨ä¿¡æ¯çš„è¡¨å¤´..

for å˜é‡2 in  å…¨å±€çš„é‚£åˆ—è¡¨ï¼š
    print(â€™å˜é‡2â€˜)
    sheet.append(å˜é‡2)
file.save('ä¿å­˜çš„è·¯å¾„\è±†ç“£çˆ¬è™«.xlsx')


'''


*****************************************************************




'''
ç¾ä¸½çš„æ±¤  2ç”¨æ³•
ä¾‹ï¼šè±†ç“£ç”µå­ä¹¦ ï¼ˆæ•°æ®åœ¨æ ‡ç­¾å¤–ï¼‰  time:   2020-04-05
æ‰¾åˆ°ç›®æ ‡æ•°æ®åœ°å€   copy-selector
æ•°æ®è½¬æ¢ æ•°æ®è½¬æ¢   å˜é‡ = BeautifulSoup(è¯·æ±‚è¿”å›.text,'html.parser')
ä¸éœ€è¦æ‰¾åˆ°æœ€å°çš„çˆ¶çº§æ ‡ç­¾

å…¨å±€ æ·»åŠ 
a = []
4 = []
5 = []
......

ä½†ã€‚ã€‚ã€‚
è§‚å¯Ÿç¬¬1ä¸ª å’Œ æœ€åä¸€ä¸ª
å˜åŒ–å½“ä¸­çš„å†…å®¹çš„æŸä¸ªå€¼ï¼ˆæ‰€é€‰å†…å®¹çš„ copy-selectorï¼‰
for i in range(0,x):
     #   ä¸€ä¸ªæ•°æ®  a
     
    a = å˜é‡.selectorï¼ˆ&quot;æ‰€é€‰å†…å®¹çš„ copy-selector(+str(i)+)&quot;ï¼‰  list æ•°æ®
    for a in a:
        print(a.get_text().replace(&quot;åˆ é™¤ä¸éœ€è¦çš„å†…å®¹&quot;,&quot;&quot;).replace()....) æ²¡æœ‰é—®é¢˜å
        a.append(a.get_text().replace(&quot;åˆ é™¤ä¸éœ€è¦çš„å†…å®¹&quot;,&quot;&quot;).replace()....)
    
    #  ç¬¬äºŒä¸ª æ•°æ®  b  ï¼ˆå¤šä¸ªå†…å®¹ '/' åˆ†å‰²å†…å®¹ ï¼Œéœ€è¦å½“ä¸­ç‰¹å®šçš„4 5 6 ----æœ‰äº›åˆ™åªæœ‰ä¸€ä¸ª(4)  å°±åˆ¤æ–­åˆ—è¡¨é•¿åº¦æœ€å°‘ä¸º4 ï¼‰
    b = å˜é‡.selectorï¼ˆ&quot;æ‰€é€‰å†…å®¹çš„ copy-selector(+str(i)+)&quot;ï¼‰  list æ•°æ®
    for b in b:
        b = b.get_text().replace(&quot;åˆ é™¤ä¸éœ€è¦çš„å†…å®¹&quot;,&quot;&quot;).replace()....
        ç‰¹æ®Šå˜é‡ï¼ˆåªä½¿ç”¨ä¸€æ¬¡ï¼‰ = b.split(&quot;/&quot;)   æ­¤æ—¶  list æ•°æ®
        if  len(ç‰¹æ®Šå˜é‡) &gt;= 4:
            4.append(ç‰¹æ®Šå˜é‡[å¯¹åº”å…·ä½“ç´¢å¼•])
            5.append(ç‰¹æ®Šå˜é‡[å¯¹åº”å…·ä½“ç´¢å¼•])
            6.append(ç‰¹æ®Šå˜é‡[å¯¹åº”å…·ä½“ç´¢å¼•])
        else:
            4.append(ç‰¹æ®Šå˜é‡[å¯¹åº”å…·ä½“ç´¢å¼•])
            5.append(&quot;æ²¡æœ‰æ•°æ®&quot;)
            6.append(&quot;æ²¡æœ‰æ•°æ®&quot;) 
        
    
    
    # æ•°æ®  ....
    ....
    
    
    ****ä¿å­˜æ•°æ® .csv æ ¼å¼****
    å…¨å±€
import csv

file_path = r'è·¯å¾„/è±†ç“£å°è¯´.csv'
with open(file_path,'w',newline=&quot;&quot;,encoding='uft-8')as f:
    filednames = ['','','','',.....]   ä¸å…¶å¯¹åº”çš„è¡¨å¤´å†…å®¹
    f_csv = csv.DictWriter(f,filednames=filednames)
    f_csv.writeheader()   å†™å…¥è¡¨å¤´
    
    #  å†™å…¥è¡Œ
    for  ? in range(0,len(a)):
        f_csv.writerow(
            {
                &quot;ä¸æ•°æ®aç›¸å…³çš„å¥æ˜&quot;ï¼ša[?],       åŠ äº†ä¸ªå­—å…¸ 
                &quot;ä¸æ•°æ®bç›¸å…³çš„å¥æ˜&quot;ï¼šb[?],
                &quot;ä¸æ•°æ®cç›¸å…³çš„å¥æ˜&quot;ï¼šc[?],
                .......
            }
        )

    






'''



</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://posierd.github.io/tag/7oTbSAx8F/" class="tag">
                    ä¸ªäººæ€»ç»“
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://posierd.github.io/post/gua-zi-er-shou-che-shu-ju/">
                  <h3 class="post-title">
                    ç“œå­äºŒæ‰‹è½¦æ•°æ®
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '19e42b5385f75be24f9c',
        clientSecret: 'bdb52c22f6310d9789a397ab02c80bc37b618bad',
        repo: 'posierd.guthub.io',
        owner: 'bverbh',
        admin: ['bverbh'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
