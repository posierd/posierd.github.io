<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>è±†ç“£ç”µå­ä¹¦ | posierd</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://posierd.github.io/favicon.ico?v=1586064626877">
<link rel="stylesheet" href="https://posierd.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ğŸ˜ƒğŸ˜ƒğŸ˜ƒ
import requests
import urllib.request
from bs4 import BeautifulSoup
import csv
'''
ç›®æ ‡æ•°æ®ï¼š
ä¹¦å
ä½œè€…
æ—¥æœŸ
ä»·æ ¼
è¯„åˆ†
è¯„ä»·äººæ•°
'''
..." />
    <meta name="keywords" content="Python-Get" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://posierd.github.io">
        <img src="https://posierd.github.io/images/avatar.png?v=1586064626877" class="site-logo">
        <h1 class="site-title">posierd</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æ¸©æ•…è€ŒçŸ¥æ–°
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://posierd.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">è±†ç“£ç”µå­ä¹¦</h2>
            <div class="post-date">2020-04-05</div>
            
            <div class="post-content" v-pre>
              <p>ğŸ˜ƒğŸ˜ƒğŸ˜ƒ</p>
<pre><code class="language-python">import requests
import urllib.request
from bs4 import BeautifulSoup
import csv
'''
ç›®æ ‡æ•°æ®ï¼š
ä¹¦å
ä½œè€…
æ—¥æœŸ
ä»·æ ¼
è¯„åˆ†
è¯„ä»·äººæ•°
'''
headers = {
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'
}
key = &quot;å°è¯´&quot;
key_ASCII = urllib.request.quote(key)


book_name_list = []
user_name = []
book_time = []
book_pice = []
pm_number_list = []
people_number_list = []


all_book = []

# for page in range(0,60,20):   # 3é¡µæ•°æ®   ç”±äºä¸å¯æŠ—æ‹’å› æ•° ï¼Œä¸éœ€è¦è·å–å¤ªæ•°ï¼ˆæ³¨ï¼š(0,1000,20)   ä¸ºå…¨éƒ¨æ•°æ®ï¼‰
#     link = &quot;https://book.douban.com/tag/&quot;+str(key_ASCII)+&quot;?start={}&amp;type=T&quot;.format(page)
#     resp = requests.get(url=link,headers=headers)
#     print(resp.status_code)
#     html = resp.text
#     ä¼˜åŒ–


# for page in  range(0,51):
#     link = &quot;https://book.douban.com/tag/&quot; + str(key_ASCII) + &quot;?start=&quot;+str(page * 20)+&quot;&amp;type=T&quot;
#     resp = requests.get(url=link,headers=headers)
#     print(&quot;ç¬¬&quot;+str(page)+&quot;é¡µçŠ¶æ€å“åº”ç :&quot;,resp.status_code)
#     ç”±äºä¸å¯æŠ—æ‹’å› æ•° ï¼Œä¸éœ€è¦è·å–å¤ªæ•°


for page in  range(0,5):  #  è¿™é‡Œè·å–5é¡µæ•°æ®
    link = &quot;https://book.douban.com/tag/&quot; + str(key_ASCII) + &quot;?start=&quot;+str(page * 20)+&quot;&amp;type=T&quot;
    resp = requests.get(url=link,headers=headers)
    print(&quot;\nç¬¬&quot;+str(page)+&quot;é¡µçŠ¶æ€å“åº”ç :&quot;,resp.status_code)
#   ç¡®å®š url  åŠå“åº”çŠ¶æ€ç 


    html = resp.text
    soup = BeautifulSoup(html,'html.parser')
#   è¿›è¡Œæ•°æ®è½¬æ¢



    #  ç¡®å®šå…ƒç´  å˜åŒ–è§„å¾‹ ä½¿ç”¨ for æ¥å®Œæˆè¿™ä¸ªè§„å¾‹
    for  i in range(1,21):
        #  ä¹¦å  è·å–
        book_name = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; h2 &gt; a&quot;)
                               #subject_list &gt; ul &gt; li:nth-child(7) &gt; div.info &gt; h2 &gt; a
                               #subject_list &gt; ul &gt; li:nth-child(2) &gt; div.info &gt; h2
        for book_name in book_name:
        #    print(book_name.get_text().replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;))
            book_name_list.append(book_name.get_text().replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;))
        #  æ­£å¸¸ 1 é¡µ 20 æ¡æ•°æ®ï¼Œä½†æœ‰å¼‚å¸¸
        #  æ­¤æ–¹æ³•è§£å†³äº† æŸé¡µæ•°æ® ä¸è¶³ 20


       #  ä¹¦ç±ä¿¡æ¯ï¼ˆä½œè€…ï¼Œå‡ºç‰ˆæ—¶é—´ï¼Œä»·æ ¼ï¼‰
        book_user = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.pub&quot;)
        for book_user in  book_user:
          #  print(book_user.get_text().replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;))
            book_user = book_user.get_text().replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;).replace(&quot;å…ƒ&quot;,&quot;&quot;)
            book_user_list = book_user.split(&quot;/&quot;)
               #  æå–å…¨éƒ¨æ•°æ®(ä½œè€…ï¼Œå‡ºç‰ˆæ—¶é—´ï¼Œä»·æ ¼)  æ¸…æ´—æ•°æ®

               #  å¼‚å¸¸è§£å†³
            if len(book_user_list) &gt;= 4:   #  è§£å†³ æŸäº›ä¹¦ç± æ²¡æœ‰è¿™äº›ä¸œè¥¿
                user_name.append(book_user_list[0])  # ä½œè€…
                book_time.append(book_user_list[-2])   #  å‡ºç‰ˆæ—¥æœŸ
                book_pice.append(book_user_list[-1])    # ä»·æ ¼
            else:
                user_name.append(book_user_list[0])  # ä½œè€…
                book_time.append(&quot;ç©º&quot;)  # å‡ºç‰ˆæ—¥æœŸ
                book_pice.append(&quot;ç©º&quot;)  # ä»·æ ¼


        # book_name = book_name[0].get_text()
        # print(book_name.replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;))
        # æ–¹æ³• 2

        #  è¯„åˆ†æ•°  è¯„ä»·äººæ•°  æ•°æ®çš„è·å–
        pm_number = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.star.clearfix &gt; span.rating_nums&quot;)
        people_number = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.star.clearfix &gt; span.pl&quot;)

        for pm_number in pm_number:
           # print(pm_number.get_text())
            pm_number_list.append(pm_number.get_text())


        for people_number in people_number:
           # print(people_number.get_text().replace(&quot; &quot;,&quot;&quot;).replace(&quot;\n&quot;,&quot;&quot;).replace(&quot;(&quot;,&quot;&quot;).replace(&quot;)&quot;,&quot;&quot;))
            people_number_list.append(people_number.get_text().replace(&quot; &quot;,&quot;&quot;).replace(&quot;\n&quot;,&quot;&quot;).replace(&quot;(&quot;,&quot;&quot;).replace(&quot;äººè¯„ä»·)&quot;,&quot;&quot;))


# print(book_name_list)
# print(user_name)
# print(book_time)
# print(book_pice)
# print(pm_number_list)
# print(people_number_list)

# å­˜å…¥å®šä¹‰å¥½çš„ç©ºåˆ—è¡¨ ï¼Œä»¥å­—å…¸çš„æ–¹å¼å­˜å…¥
# for i in range(0,len(user_name)):
#     all_book.append(
#         {
#             &quot;ä¹¦å&quot;:book_name_list[i],
#             &quot;åŸä½œè€…&quot;: user_name[i],
#             &quot;å‡ºç‰ˆæ—¥æœŸ&quot;:book_time[i],
#             &quot;ä»·æ ¼(å…ƒ)&quot;:book_pice[i],
#             &quot;è¯„åˆ†&quot;:pm_number_list[i],
#             &quot;è¯„ä»·äººæ•°&quot;:people_number_list[i],
#
#         }
#     )
#  #  æ­¤æ—¶æ˜¯ åˆ—è¡¨åŒ…å« len ï¼ˆbook_timeï¼‰ ä¸ª å­—å…¸
#  #  æ¯ä¸€ä¸ªå­—å…¸ åŒ…å«ä¸€æœ¬ä¹¦çš„ çˆ¬å–çš„ æ‰€æœ‰ä¿¡æ¯
#
# print(all_book)



#  å› ä¸ºå­˜å…¥ csv æ ¼å¼çš„æ–‡ä»¶ä¹Ÿéœ€è¦ç”¨åˆ°äº†å­—å…¸ è¿™ä¸Šé¢è¿™ä¸€æ­¥å°± pass


file_path = &quot;C:/Users/DELL/Desktop/python_wd/æ–‡æœ¬ä¿¡æ¯/è±†ç“£å°è¯´.csv&quot;
with open(file_path,&quot;w&quot;,newline=&quot;&quot;,encoding=&quot;utf-8&quot;)as f:
    file_value_names = [&quot;ä¹¦å&quot;,&quot;ä½œè€…&quot;,&quot;å‡ºç‰ˆæ—¥æœŸ&quot;,&quot;ä»·æ ¼(å…ƒ)&quot;,&quot;è¯„åˆ†&quot;,&quot;è¯„ä»·äººæ•°&quot;]  #   è®¾ç½®è¡¨å¤´
    f_csv =  csv.DictWriter(f,fieldnames=file_value_names)  #   é‡‡ç”¨å­—å…¸çš„å½¢å¼ å­˜å…¥
    f_csv.writeheader()  #   å†™å…¥è¡¨å¤´

    #  å†™å…¥è¡Œ
    for i in range(0,len(user_name)):
        f_csv.writerow(     #   æ³¨æ„è¿™é‡Œ
            {
                &quot;ä¹¦å&quot;:book_name_list[i],
                &quot;ä½œè€…&quot;: user_name[i],
                &quot;å‡ºç‰ˆæ—¥æœŸ&quot;:book_time[i],
                &quot;ä»·æ ¼(å…ƒ)&quot;:book_pice[i],
                &quot;è¯„åˆ†&quot;:pm_number_list[i],
                &quot;è¯„ä»·äººæ•°&quot;:people_number_list[i],
            }
        )



print(&quot;\næ•°æ®ä¿å­˜å®Œæ¯•ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;)



</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://posierd.github.io/tag/oYN426Mph/" class="tag">
                    Python-Get
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://posierd.github.io/post/you-mei-tu-ku-tu-pian-huo-qu/">
                  <h3 class="post-title">
                    ä¼˜ç¾å›¾åº“å›¾ç‰‡è·å–
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '19e42b5385f75be24f9c',
        clientSecret: 'bdb52c22f6310d9789a397ab02c80bc37b618bad',
        repo: 'posierd.guthub.io',
        owner: 'bverbh',
        admin: ['bverbh'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
