<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>ä½¿ç”¨  bs4  çˆ¬å–è±†ç“£ç”µå­ä¹¦ä¿¡æ¯___æ–°çš„çŸ¥è¯†ç‚¹ | posierd</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://posierd.github.io/favicon.ico?v=1585719551177">
<link rel="stylesheet" href="https://posierd.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ç›®æ ‡åœ°å€
ğŸ˜ƒğŸ˜ƒğŸ˜ƒ
çŸ¥è¯†ç‚¹æ¢³ç†ï¼š
''''
åˆ†æè±†ç“£å›¾ä¹¦è·å–æ•°æ®åŠä¿å­˜çš„æ–¹æ³•
1.  ç½‘é¡µåˆ†æ
1.1 . url å‚æ•° ï¼ˆä¾‹ å°è¯´ï¼‰  å°†å…¶ str ä¿®æ”¹ä¸º  ASCII ç¼–ç 
1.2   åœ¨  import urllib.reque..." />
    <meta name="keywords" content="Python-Get" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://posierd.github.io">
        <img src="https://posierd.github.io/images/avatar.png?v=1585719551177" class="site-logo">
        <h1 class="site-title">posierd</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      æ¸©æ•…è€ŒçŸ¥æ–°
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://posierd.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">ä½¿ç”¨  bs4  çˆ¬å–è±†ç“£ç”µå­ä¹¦ä¿¡æ¯___æ–°çš„çŸ¥è¯†ç‚¹</h2>
            <div class="post-date">2020-03-19</div>
            
            <div class="post-content" v-pre>
              <p><a href="https://book.douban.com/tag/%E5%B0%8F%E8%AF%B4?start=00&amp;type=T">ç›®æ ‡åœ°å€</a></p>
<p>ğŸ˜ƒğŸ˜ƒğŸ˜ƒ</p>
<h1 id="çŸ¥è¯†ç‚¹æ¢³ç†">çŸ¥è¯†ç‚¹æ¢³ç†ï¼š</h1>
<pre><code class="language-python">''''
åˆ†æè±†ç“£å›¾ä¹¦è·å–æ•°æ®åŠä¿å­˜çš„æ–¹æ³•
1.  ç½‘é¡µåˆ†æ
1.1 . url å‚æ•° ï¼ˆä¾‹ å°è¯´ï¼‰  å°†å…¶ str ä¿®æ”¹ä¸º  ASCII ç¼–ç 
1.2   åœ¨  import urllib.request  æˆ–   import urllib.parse  å¯¼å…¥ï¼š
        ä¾‹ï¼š key = &quot;å°è¯´&quot;
             key_ASCII = urllib.request.quote(key)
             åœ¨  æ‹¼æ¥ url æ—¶ ä¼ å…¥

1.3 . è§‚å¯Ÿ page å˜åŒ–ï¼š
        é¦–é¡µ ï¼šhttps://book.douban.com/tag/%E5%B0%8F%E8%AF%B4?start=00&amp;type=T
        ç¬¬äºŒé¡µï¼š https://book.douban.com/tag/%E5%B0%8F%E8%AF%B4?start=20&amp;type=T
        ç¬¬ä¸‰é¡µï¼š https://book.douban.com/tag/%E5%B0%8F%E8%AF%B4?start=40&amp;type=T
        ......
        è§‚å¯Ÿæœ«é¡µä¸º 50   å…¶ä¸­ star çš„å€¼ä¸º  980
         ç”±æ­¤è§„å¾‹å¾—å‡º  0 å¼€å§‹ 50   æ¯æ¬¡ *20
         start=&quot;+str(page * 20)+&quot;

2.ä½¿ç”¨ bs4  è§£ææå–æ•°æ®
2.1  å°†ç½‘é¡µ html ä»£ç è¿›è¡Œæ•°æ®è½¬æ¢
2.2  åˆ©ç”¨ è°·æ­Œæµè§ˆå…¶  copy-copy selectot æ‰¾å‡ºæ•°æ®å˜åŒ–è§„å¾‹ ï¼ˆè¿”å›çš„ç»“æœç±»å‹ä¸ºåˆ—è¡¨ï¼‰ï¼Œ
2.3  æ‰¾å‡ºè§„å¾‹å˜åŒ– ï¼Œä½¿ç”¨ for æ¥ç¬¦åˆè§„åˆ™  ï¼ˆç¬¬ä¸€ä¸ª  ï¼Œç¬¬äºŒä¸ªï¼Œæœ€åä¸€ä¸ªï¼‰æ¥è§‚å¯Ÿ
2.4  å…ˆ for å˜é‡1 in  å˜é‡1ï¼ˆå¯ä»¥é‡å¤ï¼‰ï¼š   ä½¿ç”¨ get_text() æ–¹æ³•æå–æ–‡æœ¬
2.5  ç´§éšå…¶å ä½¿ç”¨ replaceï¼ˆï¼‰æ–¹æ³• è¿›è¡Œæ•°æ®æ¸…æ´—
2.6  å½“ä¸€ä¸ªæ ‡ç­¾ä¸‹æœ‰å¤šä¸ªæ•°æ®æ—¶ï¼Œä½¿ç”¨ splitï¼ˆï¼‰  æ–¹æ³•åˆ†å‰² é—´éš”ç¬¦å·
2.7  æå– 2.5  ï¼ˆåˆ—è¡¨ä¸­çš„ç¬¬ x ä¸ªæ•°æ®ï¼Œâ€œç´¢å¼•å–å€¼â€ï¼‰


â€”â€”â€”â€”â€”â€”
ä½¿ç”¨åˆ—è¡¨å°†å†…å®¹åˆ†åˆ«åŠ å…¥åˆ—è¡¨ä¸­
æ­¤æ—¶å†…å®¹ å­˜å…¥ csv  æ–‡ä»¶ä¸­

3.  ä¿å­˜æ–‡ä»¶ csv æ ¼å¼
3.1  ä¸€ä¸ªå˜é‡å æ¥æ¥å— æ–‡ä»¶ä¿å­˜çš„è·¯å¾„  å°† \ ä¿®æ”¹ä¸º  /  åœ¨åŠ å…¥æ–‡ä»¶åï¼ˆä¾‹ï¼šfile_path = &quot;C:/Users/DELL/Desktop/python_wd/æ–‡æœ¬ä¿¡æ¯/è±†ç“£å°è¯´.csv&quot;ï¼‰
3.2  with open(file_path,&quot;w&quot;,newline=&quot;&quot;,encoding=&quot;utf-8&quot;)as f: å…¶ä¸­çš„  newline  ä¸ºè§£å†³æ¯éš”ä¸€è¡Œåœ¨å†™å…¥å†…å®¹
3.3  file_value_names = [&quot;ä¹¦å&quot;,&quot;ä½œè€…&quot;,&quot;å‡ºç‰ˆæ—¥æœŸ&quot;,&quot;ä»·æ ¼(å…ƒ)&quot;,&quot;è¯„åˆ†&quot;,&quot;è¯„ä»·äººæ•°&quot;]  #   è®¾ç½®è¡¨å¤´  è®°ä½æ ¼å¼
3.4  f_csv =  csv.DictWriter(f,fieldnames=file_value_names)  #   é‡‡ç”¨å­—å…¸çš„å½¢å¼ å­˜å…¥ csv  æ–‡ä»¶ä¸­
3.5  f_csv.writeheader()  #   å†™å…¥è¡¨å¤´
3.6      #  å†™å…¥è¡Œ
    for i in range(0,len(user_name)):
        f_csv.writerow(
            {
                &quot;ä¹¦å&quot;:book_name_list[i],
                &quot;ä½œè€…&quot;: user_name[i],
                &quot;å‡ºç‰ˆæ—¥æœŸ&quot;:book_time[i],
                &quot;ä»·æ ¼(å…ƒ)&quot;:book_pice[i],
                &quot;è¯„åˆ†&quot;:pm_number_list[i],
                &quot;è¯„ä»·äººæ•°&quot;:people_number_list[i],
            }
        )


</code></pre>
<h2 id="ä¸‹é¢æ˜¯ä»£ç éƒ¨åˆ†">ä¸‹é¢æ˜¯ä»£ç éƒ¨åˆ†ï¼š</h2>
<pre><code class="language-python">import requests
import urllib.request
from bs4 import BeautifulSoup
import csv
'''
ç›®æ ‡æ•°æ®ï¼š
ä¹¦å
ä½œè€…
æ—¥æœŸ
ä»·æ ¼
è¯„åˆ†
è¯„ä»·äººæ•°
'''
headers = {
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'
}
key = &quot;å°è¯´&quot;
key_ASCII = urllib.request.quote(key)


book_name_list = []
user_name = []
book_time = []
book_pice = []
pm_number_list = []
people_number_list = []


all_book = []

# for page in range(0,60,20):   # 3é¡µæ•°æ®   ç”±äºä¸å¯æŠ—æ‹’å› æ•° ï¼Œä¸éœ€è¦è·å–å¤ªæ•°ï¼ˆæ³¨ï¼š(0,1000,20)   ä¸ºå…¨éƒ¨æ•°æ®ï¼‰
#     link = &quot;https://book.douban.com/tag/&quot;+str(key_ASCII)+&quot;?start={}&amp;type=T&quot;.format(page)
#     resp = requests.get(url=link,headers=headers)
#     print(resp.status_code)
#     html = resp.text
#     ä¼˜åŒ–


# for page in  range(0,51):
#     link = &quot;https://book.douban.com/tag/&quot; + str(key_ASCII) + &quot;?start=&quot;+str(page * 20)+&quot;&amp;type=T&quot;
#     resp = requests.get(url=link,headers=headers)
#     print(&quot;ç¬¬&quot;+str(page)+&quot;é¡µçŠ¶æ€å“åº”ç :&quot;,resp.status_code)
#     ç”±äºä¸å¯æŠ—æ‹’å› æ•° ï¼Œä¸éœ€è¦è·å–å¤ªæ•°


for page in  range(0,5):  #  è¿™é‡Œè·å–5é¡µæ•°æ®
    link = &quot;https://book.douban.com/tag/&quot; + str(key_ASCII) + &quot;?start=&quot;+str(page * 20)+&quot;&amp;type=T&quot;
    resp = requests.get(url=link,headers=headers)
    print(&quot;\nç¬¬&quot;+str(page)+&quot;é¡µçŠ¶æ€å“åº”ç :&quot;,resp.status_code)
#   ç¡®å®š url  åŠå“åº”çŠ¶æ€ç 


    html = resp.text
    soup = BeautifulSoup(html,'html.parser')
#   è¿›è¡Œæ•°æ®è½¬æ¢



    #  ç¡®å®šå…ƒç´  å˜åŒ–è§„å¾‹ ä½¿ç”¨ for æ¥å®Œæˆè¿™ä¸ªè§„å¾‹
    for  i in range(1,21):
        #  ä¹¦å  è·å–
        book_name = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; h2 &gt; a&quot;)
                               #subject_list &gt; ul &gt; li:nth-child(7) &gt; div.info &gt; h2 &gt; a
                               #subject_list &gt; ul &gt; li:nth-child(2) &gt; div.info &gt; h2
        for book_name in book_name:
        #    print(book_name.get_text().replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;))
            book_name_list.append(book_name.get_text().replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;))
        #  æ­£å¸¸ 1 é¡µ 20 æ¡æ•°æ®ï¼Œä½†æœ‰å¼‚å¸¸
        #  æ­¤æ–¹æ³•è§£å†³äº† æŸé¡µæ•°æ® ä¸è¶³ 20


       #  ä¹¦ç±ä¿¡æ¯ï¼ˆä½œè€…ï¼Œå‡ºç‰ˆæ—¶é—´ï¼Œä»·æ ¼ï¼‰
        book_user = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.pub&quot;)
        for book_user in  book_user:
          #  print(book_user.get_text().replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;))
            book_user = book_user.get_text().replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;).replace(&quot;å…ƒ&quot;,&quot;&quot;)
            book_user_list = book_user.split(&quot;/&quot;)
               #  æå–å…¨éƒ¨æ•°æ®(ä½œè€…ï¼Œå‡ºç‰ˆæ—¶é—´ï¼Œä»·æ ¼)  æ¸…æ´—æ•°æ®

               #  å¼‚å¸¸è§£å†³
            if len(book_user_list) &gt;= 4:   #  è§£å†³ æŸäº›ä¹¦ç± æ²¡æœ‰è¿™äº›ä¸œè¥¿
                user_name.append(book_user_list[0])  # ä½œè€…
                book_time.append(book_user_list[-2])   #  å‡ºç‰ˆæ—¥æœŸ
                book_pice.append(book_user_list[-1])    # ä»·æ ¼
            else:
                user_name.append(book_user_list[0])  # ä½œè€…
                book_time.append(&quot;ç©º&quot;)  # å‡ºç‰ˆæ—¥æœŸ
                book_pice.append(&quot;ç©º&quot;)  # ä»·æ ¼


        # book_name = book_name[0].get_text()
        # print(book_name.replace(&quot;\n&quot;,&quot;&quot;).replace(&quot; &quot;,&quot;&quot;))
        # æ–¹æ³• 2

        #  è¯„åˆ†æ•°  è¯„ä»·äººæ•°  æ•°æ®çš„è·å–
        pm_number = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.star.clearfix &gt; span.rating_nums&quot;)
        people_number = soup.select(&quot;#subject_list &gt; ul &gt; li:nth-child(&quot;+str(i)+&quot;) &gt; div.info &gt; div.star.clearfix &gt; span.pl&quot;)

        for pm_number in pm_number:
           # print(pm_number.get_text())
            pm_number_list.append(pm_number.get_text())


        for people_number in people_number:
           # print(people_number.get_text().replace(&quot; &quot;,&quot;&quot;).replace(&quot;\n&quot;,&quot;&quot;).replace(&quot;(&quot;,&quot;&quot;).replace(&quot;)&quot;,&quot;&quot;))
            people_number_list.append(people_number.get_text().replace(&quot; &quot;,&quot;&quot;).replace(&quot;\n&quot;,&quot;&quot;).replace(&quot;(&quot;,&quot;&quot;).replace(&quot;äººè¯„ä»·)&quot;,&quot;&quot;))


# print(book_name_list)
# print(user_name)
# print(book_time)
# print(book_pice)
# print(pm_number_list)
# print(people_number_list)

# å­˜å…¥å®šä¹‰å¥½çš„ç©ºåˆ—è¡¨ ï¼Œä»¥å­—å…¸çš„æ–¹å¼å­˜å…¥
# for i in range(0,len(user_name)):
#     all_book.append(
#         {
#             &quot;ä¹¦å&quot;:book_name_list[i],
#             &quot;åŸä½œè€…&quot;: user_name[i],
#             &quot;å‡ºç‰ˆæ—¥æœŸ&quot;:book_time[i],
#             &quot;ä»·æ ¼(å…ƒ)&quot;:book_pice[i],
#             &quot;è¯„åˆ†&quot;:pm_number_list[i],
#             &quot;è¯„ä»·äººæ•°&quot;:people_number_list[i],
#
#         }
#     )
#  #  æ­¤æ—¶æ˜¯ åˆ—è¡¨åŒ…å« len ï¼ˆbook_timeï¼‰ ä¸ª å­—å…¸
#  #  æ¯ä¸€ä¸ªå­—å…¸ åŒ…å«ä¸€æœ¬ä¹¦çš„ çˆ¬å–çš„ æ‰€æœ‰ä¿¡æ¯
#
# print(all_book)



#  å› ä¸ºå­˜å…¥ csv æ ¼å¼çš„æ–‡ä»¶ä¹Ÿéœ€è¦ç”¨åˆ°äº†å­—å…¸ è¿™ä¸Šé¢è¿™ä¸€æ­¥å°± pass


file_path = &quot;C:/Users/DELL/Desktop/python_wd/æ–‡æœ¬ä¿¡æ¯/è±†ç“£å°è¯´.csv&quot;
with open(file_path,&quot;w&quot;,newline=&quot;&quot;,encoding=&quot;utf-8&quot;)as f:
    file_value_names = [&quot;ä¹¦å&quot;,&quot;ä½œè€…&quot;,&quot;å‡ºç‰ˆæ—¥æœŸ&quot;,&quot;ä»·æ ¼(å…ƒ)&quot;,&quot;è¯„åˆ†&quot;,&quot;è¯„ä»·äººæ•°&quot;]  #   è®¾ç½®è¡¨å¤´
    f_csv =  csv.DictWriter(f,fieldnames=file_value_names)  #   é‡‡ç”¨å­—å…¸çš„å½¢å¼ å­˜å…¥
    f_csv.writeheader()  #   å†™å…¥è¡¨å¤´

    #  å†™å…¥è¡Œ
    for i in range(0,len(user_name)):
        f_csv.writerow(     #   æ³¨æ„è¿™é‡Œ
            {
                &quot;ä¹¦å&quot;:book_name_list[i],
                &quot;ä½œè€…&quot;: user_name[i],
                &quot;å‡ºç‰ˆæ—¥æœŸ&quot;:book_time[i],
                &quot;ä»·æ ¼(å…ƒ)&quot;:book_pice[i],
                &quot;è¯„åˆ†&quot;:pm_number_list[i],
                &quot;è¯„ä»·äººæ•°&quot;:people_number_list[i],
            }
        )



print(&quot;\næ•°æ®ä¿å­˜å®Œæ¯•ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚&quot;)




</code></pre>
<h2 id="è¿è¡Œä»£ç æ•°æ®éƒ¨åˆ†ç»“æœ">è¿è¡Œä»£ç æ•°æ®éƒ¨åˆ†ç»“æœï¼š</h2>
<figure data-type="image" tabindex="1"><img src="https://posierd.github.io/post-images/1584592879635.png" alt="" loading="lazy"></figure>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”END</p>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://posierd.github.io/tag/oYN426Mph/" class="tag">
                    Python-Get
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://posierd.github.io/post/xpath-yu-fa-li-jie/">
                  <h3 class="post-title">
                    Xpath è¯­æ³•ç†è§£
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>




  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '19e42b5385f75be24f9c',
        clientSecret: 'bdb52c22f6310d9789a397ab02c80bc37b618bad',
        repo: 'posierd.guthub.io',
        owner: 'bverbh',
        admin: ['bverbh'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
