<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://posierd.github.io</id>
    <title>posierd_Gridea</title>
    <updated>2020-03-07T05:53:14.932Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://posierd.github.io"/>
    <link rel="self" href="https://posierd.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://posierd.github.io/images/avatar.png</logo>
    <icon>https://posierd.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, posierd_Gridea</rights>
    <entry>
        <title type="html"><![CDATA[selenium æ¨¡æ‹Ÿæµè§ˆå™¨ çˆ¬å–ç½‘æ˜“äº‘éŸ³ä¹è¯„è®º]]></title>
        <id>https://posierd.github.io/post/selenium-mo-ni-liu-lan-qi-pa-qu-wang-yi-yun-yin-le-ping-lun/</id>
        <link href="https://posierd.github.io/post/selenium-mo-ni-liu-lan-qi-pa-qu-wang-yi-yun-yin-le-ping-lun/">
        </link>
        <updated>2020-03-07T05:22:58.000Z</updated>
        <content type="html"><![CDATA[<p>æœ¬æ¥ç›¸ç”¨ç ´è§£ jsæ¥åš ä½†ç½‘ä¸Šæ‰¾äº†å¾ˆå¤šæ¡ˆä¾‹ ï¼Œè¿˜æ˜¯æä¸æ‡‚ï¼Œæœ€åè¿˜æ˜¯ç”¨è¿™ç§è¾¾åˆ°äº†æˆ‘éœ€è¦çš„æ•ˆæœ</p>
<p>ğŸ˜ƒğŸ˜ƒğŸ˜ƒ</p>
<pre><code class="language-python">from selenium import webdriver
import time

class Yunspider(object):
    # åˆå§‹åŒ–çš„ä¸œè¥¿ å¯ä»¥åœ¨åç»­çš„å‡½æ•°ä¸­ä½¿ç”¨
    '''åˆå§‹åŒ–æ–¹æ³•'''
    def __init__(self,url):
        '''åˆå§‹åŒ–ç½‘å€'''
        self.url = url
        # æ‰“å¼€æµè§ˆå™¨
        self.driver = webdriver.Chrome()
    # æ‰“å¼€ç›®æ ‡ç½‘å€ æå–æ•°æ® ç¿»é¡µ
    def getContent(self):
        # æ‰“å¼€ç›®æ ‡ç½‘å€
        self.driver.get(self.url)
        # jsè¯­å¥ ï¼Œæ§åˆ¶ä¸‹æ»‘çš„é‚£ä¸ªè¿›åº¦æ¡
        js = 'window.scrollBy(0,8000)'
        #  å…ˆè¿›å…¥ IFrame
        self.driver.switch_to.frame(0) #  0 è¡¨ç¤ºç¬¬ä¸€ä¸ªæ¡†
        #  æ‰§è¡Œè¿™æ¡ js è¯­å¥
        self.driver.execute_script(js)

        # æå–æ•°æ®   ç¿»é¡µ

        for page in range(0,6):
            selectors = self.driver.find_elements_by_xpath('//div[@class=&quot;cmmts j-flag&quot;]/div')
            for selector in selectors:
                text = selector.find_element_by_xpath('.//div[@class=&quot;cnt f-brk&quot;]').text
                print(text)
                self.save(text)
                #Yunspider.save(text)  ä¹Ÿå¯ä»¥è°ƒç”¨


            # find_element_by_partial_link_text  æ¨¡ç³ŠåŒ¹é…
            newpage = self.driver.find_element_by_partial_link_text('ä¸‹ä¸€é¡µ')
            newpage.click()
            time.sleep(2)
    @staticmethod    #  é™æ€å†™æ³•
    def save(item):
        with open(r'C:\Users\DELL\Desktop\python_wd\æ–‡æœ¬ä¿¡æ¯\ç½‘æ˜“äº‘è¯„è®º.txt','a',encoding='utf-8')as f:
            f.write(&quot;\n&quot;)
            f.write(item)
            f.write(&quot;\n &quot;)




if __name__ == '__main__':
    url = 'https://music.163.com/#/song?id=491274636'
    Yunspider = Yunspider(url)
    Yunspider.getContent()

</code></pre>
<p>è¿è¡Œä»£ç æ•°æ®éƒ¨åˆ†ç»“æœï¼š<br>
<img src="https://posierd.github.io/post-images/1583558646684.png" alt="" loading="lazy"></p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”END</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[selenium  æ¨¡æ‹Ÿæµè§ˆå™¨ç‚¹å‡»ç¿»é¡µ]]></title>
        <id>https://posierd.github.io/post/selenium-mo-ni-liu-lan-qi-dian-ji-fan-ye/</id>
        <link href="https://posierd.github.io/post/selenium-mo-ni-liu-lan-qi-dian-ji-fan-ye/">
        </link>
        <updated>2020-03-07T05:18:22.000Z</updated>
        <content type="html"><![CDATA[<pre><code class="language-python">from selenium import webdriver
import time
driver = webdriver.Chrome()
driver.get('https://www.baidu.com/s?ie=UTF-8&amp;wd=python')
for page in range(1,3):
    time.sleep(10)
    nwepage = driver.find_element_by_partial_link_text('ä¸‹ä¸€é¡µ')
    nwepage.click()
    time.sleep(10)
#driver.quit()
</code></pre>
<p>è¿è¡Œä»£ç æ²¡æœ‰æŠ¥é”™ï¼š<br>
é‚£æ®µjsä¸ä¼šï¼Œè§‚å¯Ÿå†…å®¹å˜åŒ–ä¹Ÿå¯ä»¥çŸ¥é“ï¼ ï¼Œä»–ç¿»é¡µäº†<br>
â€”â€”â€”â€”â€”â€”â€”â€” ENDğŸ˜ŠğŸ˜ƒğŸ˜ƒ</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[selenium æ¨¡æ‹Ÿé¼ æ ‡ç‚¹å‡»æ”¶æœç»“æœ]]></title>
        <id>https://posierd.github.io/post/selenium-mo-ni-shu-biao-dian-ji-shou-sou-jie-guo/</id>
        <link href="https://posierd.github.io/post/selenium-mo-ni-shu-biao-dian-ji-shou-sou-jie-guo/">
        </link>
        <updated>2020-03-07T05:12:47.000Z</updated>
        <content type="html"><![CDATA[<pre><code class="language-python">from selenium import webdriver
import time
dr = webdriver.Chrome()  #  åˆå§‹åŒ– Chrome æµè§ˆå™¨å®ä¾‹
dr.get('http://www.baidu.com')  # æ‰“å¼€ç™¾åº¦é¦–é¡µ
dr.find_element_by_id('kw').send_keys('ç¾å¥³')  # å®šä½è¾“å…¥æ¡†å¹¶åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å…³é”®å­—
dr.find_element_by_id('su').click()
# å®šä½ ç‚¹å‡» æœç´¢  æŒ‰é’®  ï¼Œå¹¶æ¨¡æ‹Ÿç‚¹å‡»
# æ¨¡ç³ŠæŸ¥æ‰¾
na = dr.find_element_by_partial_link_text('_æµ·é‡ç²¾é€‰é«˜æ¸…å›¾ç‰‡_ç™¾åº¦å›¾ç‰‡')
na.click()  # æ¨¡æ‹Ÿç‚¹å‡»
time.sleep(10)  # ç†è§£ä¸ºæš‚åœ 10 ç§’
dr.quit()  # å…³é—­æµè§ˆå™¨
# dr.refresh() ç½‘é¡µåˆ·æ–°

</code></pre>
<p>è¿è¡Œç»“æœï¼š</p>
<p>ä¸ä¼šä¸ŠåŠ¨å›¾ï¼Œä½†è¿è¡Œä»£ç æ˜¯æ²¡æœ‰é”™è¯¯çš„ï¼ï¼ï¼ï¼Œæ˜¯æˆ‘æœŸæœ›çš„ã€‚ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”END</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[çˆ¬å–è£è€€è‹±é›„å›¾ç‰‡]]></title>
        <id>https://posierd.github.io/post/pa-qu-rong-yao-ying-xiong-tu-pian/</id>
        <link href="https://posierd.github.io/post/pa-qu-rong-yao-ying-xiong-tu-pian/">
        </link>
        <updated>2020-03-07T05:05:16.000Z</updated>
        <content type="html"><![CDATA[<p>ç›®æ ‡åœ°å€å°±ä¸æ”¾äº†</p>
<p>ğŸ˜„ğŸ˜„ğŸ˜„</p>
<pre><code class="language-python">import requests
import json
import time
start_time = time.time()
link = 'https://pvp.qq.com/web201605/js/herolist.json'
headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.122 Safari/537.36'
}
r = requests.get(link,headers=headers)
print(&quot;é¡µé¢çŠ¶æ€å“åº”ç : &quot;,r.status_code)
html = r.text
list = json.loads(html)
for img in list:
    bianhao = img['ename']
    name = img['cname']
    try:
        pifu = img['skin_name'].split('|') # åˆ‡å‰² ç”¨æ¥è®¡ç®—æœ‰å¤šå°‘çš®è‚¤
    except Exception as b:
        print(b)
    for mess in range(1,len(pifu) + 1):
       img_url = ' http://game.gtimg.cn/images/yxzj/img201606/skin/hero-info/' + str(bianhao) + '/'+str(bianhao)+'-bigskin-{}.jpg'.format(mess)
       img_content = requests.get(img_url,headers=headers).content
       with open(r'C:\Users\DELL\Desktop\python_wd\mig\è£è€€å›¾ç‰‡\\'+name + '-' + pifu[mess - 1]+ '.jpg','wb')as f:
           print(&quot;æ­£åœ¨ä¸‹è½½å›¾ç‰‡ï¼š&quot;, name + '-' + pifu[mess - 1])
           f.write(img_content)
end_time = time.time()
all_time = start_time + end_time
print(&quot;ç¨‹åºè€—æ—¶ï¼ˆå•ä½ï¼šç§’ï¼‰ï¼š&quot;,all_time)
print(&quot;ä¸‹è½½å®Œæˆã€‚ã€‚ã€‚&quot;)

</code></pre>
<p>è¿è¡Œä»£ç æ•°æ®éƒ¨åˆ†ç»“æœï¼š<br>
<img src="https://posierd.github.io/post-images/1583557696227.png" alt="" loading="lazy"></p>
<p>â€”â€”â€”â€”â€”â€”END</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æˆ¿æºä¿¡æ¯â€”éƒ‘å· å­˜å…¥ .xlsxæ–‡ä»¶ä¸­]]></title>
        <id>https://posierd.github.io/post/fang-yuan-xin-xi-zheng-zhou-cun-ru-xlsx-wen-jian-zhong/</id>
        <link href="https://posierd.github.io/post/fang-yuan-xin-xi-zheng-zhou-cun-ru-xlsx-wen-jian-zhong/">
        </link>
        <updated>2020-03-07T04:51:44.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://zz.lianjia.com/ershoufang/">ç›®æ ‡åœ°å€</a></p>
<p>ğŸ˜„ğŸ˜„ğŸ˜ƒ</p>
<pre><code class="language-python">import requests
from bs4 import BeautifulSoup
import openpyxl

# https://zz.lianjia.com/ershoufang/
# https://zz.lianjia.com/ershoufang/pg2/
# https://zz.lianjia.com/ershoufang/pg3/

list = []
for page in range(1,3):
    print(&quot;æ­£åœ¨çˆ¬å–{}é¡µæ•°æ®&quot;.format(page))
    link = 'https://zz.lianjia.com/ershoufang/pg+str(page)/'
    headers = {
        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.116 Safari/537.36'
    }
    r = requests.get(link,headers=headers)
    print(&quot;é¡µé¢çŠ¶æ€å“åº”ç : &quot;,r.status_code)


    soup = BeautifulSoup(r.text,'html.parser')
    #ä¸€ä¸ªæˆ¿å­çš„æ€»æ•°æ® æœ€å°
    host_list = soup.find_all('div',class_='info clear')
    for host in host_list:
        name = host.find('a',class_='').get_text()
        jinjia = host.find('div',class_='unitPrice').get_text()
        zongjia = host.find('div',class_='totalPrice').get_text()
        ip = host.find('div',class_='positionInfo').get_text()
        guige = host.find('div',class_='houseInfo').get_text()
        guige = guige.replace('|','')
        miaoshu = host.find('div',class_='tag').get_text()
        #print(miaoshu)
        list.append([name,jinjia,zongjia,ip,guige,miaoshu])




# ä¿å­˜æ•°æ®
file = openpyxl.Workbook()   #  æ–°å»ºä¸€ä¸ªå·¥ä½œè–„
sheet = file.active     #  åœ¨å»ºç«‹å·¥ä½œè–„åå»ºç«‹å·¥ä½œè¡¨
sheet.title = 'æˆ¿æºä¿¡æ¯'   #  å‘½å
# å†™å…¥å†…å®¹ æ ¼å¼
sheet['A1'] = 'åå­—'
sheet['B1'] = 'å‡ä»·'
sheet['C1'] = 'æ€»ä»·'
sheet['D1'] = 'åœ°å€'
sheet['E1'] = 'è§„æ ¼'
sheet['F1'] = 'æè¿°'

for i in list:
    print(i)
    sheet.append(i)
file.save(r&quot;C:\Users\DELL\Desktop\python_wd\æ–‡æœ¬ä¿¡æ¯\æˆ¿æºä¿¡æ¯-éƒ‘å·.xlsx&quot;)  #  ä¿å­˜è‡ªå®šä¹‰ç›®å½•



</code></pre>
<p>è¿è¡Œä»£ç æ•°æ®éƒ¨åˆ†ç»“æœï¼š<br>
<img src="https://posierd.github.io/post-images/1583557146044.png" alt="" loading="lazy"></p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”END</p>
]]></content>
    </entry>
</feed>